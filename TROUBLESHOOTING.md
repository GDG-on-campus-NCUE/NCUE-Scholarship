# 檔案上傳錯誤排除指南

## "Unable to add filesystem: <illegal path>" 錯誤

### 可能原因與解決方案

#### 1. 檔案名稱包含非法字符
**症狀**: 上傳檔案時出現 "illegal path" 錯誤

**解決方案**:
- 確保檔案名稱不包含以下字符: `< > : " | ? * \x00-\x1f`
- 建議重新命名檔案，只使用英文字母、數字、中文字符、連字號和底線

#### 2. 檔案路徑過長
**症狀**: 長檔案名稱或深層資料夾結構導致錯誤

**解決方案**:
- 確保完整檔案路徑不超過 260 字符（Windows 限制）
- 檔案名稱建議不超過 100 字符

#### 3. 瀏覽器安全限制
**症狀**: 某些瀏覽器對檔案存取有嚴格限制

**解決方案**:
- 嘗試使用不同瀏覽器（Chrome, Firefox, Edge）
- 清除瀏覽器快取和 cookies
- 確保瀏覽器允許檔案存取

#### 4. 檔案權限問題
**症狀**: 檔案被其他程式佔用或無讀取權限

**解決方案**:
- 確保檔案未被其他程式開啟
- 檢查檔案權限是否允許讀取
- 嘗試複製檔案到新位置後再上傳

#### 5. 系統相關問題
**症狀**: 特定作業系統或檔案系統限制

**解決方案**:
- Windows: 避免使用保留檔案名稱（CON, PRN, AUX 等）
- macOS: 避免檔案名稱以點號開頭
- Linux: 確保檔案編碼為 UTF-8

### 已實施的修復

1. **檔案名稱清理**: 自動移除或替換非法字符
2. **路徑驗證**: 檢查檔案路徑有效性
3. **長度限制**: 限制檔案名稱和路徑長度
4. **錯誤捕獲**: 詳細的錯誤訊息和記錄
5. **安全檢查**: 多層次的檔案安全驗證

### 測試步驟

1. 嘗試上傳簡單英文檔名的檔案
2. 測試包含中文字符的檔案
3. 驗證不同檔案類型的上傳
4. 檢查檔案大小限制
5. 測試拖放功能

### 調試方法

1. **開啟瀏覽器開發者工具**
   ```
   F12 -> Console 頁籤
   ```

2. **查看詳細錯誤訊息**
   ```javascript
   // 檢查 console.log 輸出
   // 尋找檔案處理相關錯誤
   ```

3. **檢查網路請求**
   ```
   F12 -> Network 頁籤 -> 上傳檔案時查看請求狀態
   ```

### 緊急解決方案

如果問題持續存在：

1. **重新命名檔案**: 使用簡單的英文檔名
2. **壓縮檔案**: 將問題檔案放入 ZIP 壓縮檔
3. **分批上傳**: 一次只上傳一個檔案
4. **重啟瀏覽器**: 完全關閉並重新開啟瀏覽器

### 聯絡支援

如果所有解決方案都無效，請提供以下資訊：

1. 瀏覽器類型和版本
2. 作業系統資訊
3. 檔案名稱和類型
4. 完整的錯誤訊息
5. Console 的錯誤記錄
