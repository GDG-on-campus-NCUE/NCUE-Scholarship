"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6392],{25215:(e,r,t)=>{t.d(r,{A:()=>a});let a=t(51030).A},36184:(e,r,t)=>{t.d(r,{A:()=>n});var a=t(95155);let s=(0,t(12115).forwardRef)((e,r)=>{let{children:t,className:s="",variant:n="ghost",size:l="default",disabled:o=!1,loading:i=!1,tooltip:c,...u}=e,d={primary:"\n      bg-primary text-white border border-primary\n      hover:bg-primary-600 hover:border-primary-600\n      focus:ring-primary/20\n    ",secondary:"\n      bg-white text-primary border border-primary\n      hover:bg-primary/5 hover:border-primary-600\n      focus:ring-primary/20\n    ",success:"\n      bg-success text-white border border-success\n      hover:bg-green-600 hover:border-green-600\n      focus:ring-success/20\n    ",danger:"\n      bg-error text-white border border-error\n      hover:bg-red-600 hover:border-red-600\n      focus:ring-error/20\n    ",warning:"\n      bg-accent text-gray-800 border border-accent\n      hover:bg-yellow-500 hover:border-yellow-500\n      focus:ring-accent/20\n    ",ghost:"\n      bg-transparent text-gray-600 border border-transparent\n      hover:bg-gray-100 hover:text-gray-900\n      focus:ring-gray-500/20\n    ",outline:"\n      bg-transparent text-gray-700 border border-gray-300\n      hover:bg-gray-50 hover:border-gray-400\n      focus:ring-gray-500/20\n    "},h={sm:"p-1.5 text-sm w-8 h-8",default:"p-2 text-base w-10 h-10",lg:"p-3 text-lg w-12 h-12",xl:"p-4 text-xl w-14 h-14"},g="\n    ".concat("\n    inline-flex items-center justify-center \n    font-medium rounded-lg transition-all duration-300 \n    focus:outline-none focus:ring-2 focus:ring-offset-2 \n    disabled:opacity-50 disabled:cursor-not-allowed\n    transform hover:scale-110 active:scale-95\n    shadow-sm hover:shadow-md\n  ","\n    ").concat(d[n]||d.ghost,"\n    ").concat(h[l]||h.default,"\n    ").concat(o?"hover:scale-100 active:scale-100":"","\n    ").concat(s,"\n  ").trim(),p=(0,a.jsx)("button",{ref:r,className:g,disabled:o||i,...u,children:i?(0,a.jsxs)("svg",{className:"animate-spin h-4 w-4",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"m100 50c0 27.614-22.386 50-50 50s-50-22.386-50-50 22.386-50 50-50 50 22.386 50 50zm-90.196 0c0 22.091 17.909 40 40 40s40-17.909 40-40-17.909-40-40-40-40 17.909-40 40z"})]}):t});return c?(0,a.jsxs)("div",{className:"relative group",children:[p,(0,a.jsxs)("div",{className:"absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-2 py-1 text-xs text-white bg-gray-900 rounded-md opacity-0 group-hover:opacity-100 transition-opacity duration-200 pointer-events-none whitespace-nowrap z-50",children:[c,(0,a.jsx)("div",{className:"absolute top-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"})]})]}):p});s.displayName="IconButton";let n=s},45749:(e,r,t)=>{t.d(r,{N:()=>l});var a=t(55647);let s="https://scholarship-api.ncuesa.org.tw",n="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzU0NDA5NjAwLCJleHAiOjE5MTIxNzYwMDB9.jqoKh3OJbr8hsKd1CTuz6UcEPGuzO_gZEL9HT67q_GY";if(!s||!n)throw console.error("Supabase configuration:",{url:s,hasAnonKey:!!n}),Error("Missing Supabase environment variables. Please check your .env.local file.");console.log("[SUPABASE-CLIENT] Configured with URL:",s);let l=(0,a.UU)(s,n)},51030:(e,r,t)=>{t.d(r,{O:()=>c,A:()=>i});var a=t(95155),s=t(12115),n=t(45749);let l={async signUp(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let{data:a,error:s}=await n.N.auth.signUp({email:e,password:r,options:{data:{name:t.name,student_id:t.student_id,department:t.department,year:t.year},emailRedirectTo:"".concat(window.location.origin,"/auth/callback")}});if(s)throw s;return{success:!0,data:a}}catch(e){return console.error("Sign-up failed:",e),{success:!1,error:e.message}}},async signIn(e,r){try{let{data:t,error:a}=await n.N.auth.signInWithPassword({email:e,password:r});if(a)throw a;return{success:!0,data:t}}catch(e){return{success:!1,error:e.message}}},async signOut(){try{let{error:e}=await n.N.auth.signOut();if(e)throw e;return{success:!0}}catch(e){return{success:!1,error:e.message}}},async getCurrentUser(){try{let{data:{user:e},error:r}=await n.N.auth.getUser();if(r)throw r;if(e){let{data:r,error:t}=await n.N.from("profiles").select("*").eq("id",e.id).single();return t&&"PGRST116"!==t.code&&console.error("Error fetching profile:",t),{success:!0,user:{...e,profile:r||null,role:(null==r?void 0:r.role)||"user"}}}return{success:!0,user:null}}catch(e){return{success:!1,error:e.message}}},async getUserProfile(e){try{let{data:r,error:t}=await n.N.from("profiles").select("*").eq("id",e).single();if(t)throw t;return{success:!0,data:r}}catch(e){return{success:!1,error:e.message}}},async resetPassword(e){try{let{error:r}=await n.N.auth.resetPasswordForEmail(e,{redirectTo:"".concat(window.location.origin,"/reset-password")});if(r)throw r;return{success:!0}}catch(e){return{success:!1,error:e.message}}},async updatePassword(e){try{let{error:r}=await n.N.auth.updateUser({password:e});if(r)throw r;return{success:!0}}catch(e){return{success:!1,error:e.message}}},async updateProfile(e){let{name:r,student_id:t,department:a,year:s}=e;try{let{data:e,error:l}=await n.N.auth.updateUser({data:{name:r,student_id:t,department:a,year:s}});if(l)throw l;let o=e.user.id,{error:i}=await n.N.from("profiles").update({username:r,student_id:t,department:a,year:s}).eq("id",o);if(i)throw i;return{success:!0,user:e.user}}catch(e){return console.error("更新個人資料失敗:",e),{success:!1,error:e.message}}},async verifyOtp(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"email";try{let{data:a,error:s}=await n.N.auth.verifyOtp({email:e,token:r,type:t});if(s)throw s;return{success:!0,data:a}}catch(e){return{success:!1,error:e.message}}},async resendOtp(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup";try{let{error:t}=await n.N.auth.resend({type:r,email:e});if(t)throw t;return{success:!0}}catch(e){return{success:!1,error:e.message}}},onAuthStateChange:e=>n.N.auth.onAuthStateChange((r,t)=>{e(r,t)})},o=(0,s.createContext)({}),i=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useAuth must be used within an AuthProvider");return e},c=e=>{let{children:r}=e,[t,i]=(0,s.useState)(null),[c,u]=(0,s.useState)(!0),[d,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{let e=async()=>{let e=await l.getCurrentUser();e.success&&e.user&&i(e.user),u(!1)};e();let{data:{subscription:r}}=l.onAuthStateChange(async(r,t)=>{if("SIGNED_IN"===r&&(null==t?void 0:t.user)){var a;let r=t.user,{data:s}=await n.N.from("profiles").select("id").eq("id",r.id).single();!s&&(null==(a=r.raw_user_meta_data)?void 0:a.name)&&(await n.N.from("profiles").insert({id:r.id,username:r.raw_user_meta_data.name,student_id:r.raw_user_meta_data.student_id,role:"user"}),await n.N.auth.updateUser({data:{display_name:r.raw_user_meta_data.name}})),await e(),h(null)}else"SIGNED_OUT"===r&&(i(null),h(null));u(!1)});return()=>{null==r||r.unsubscribe()}},[]);let g={user:t,loading:c,error:d,signUp:async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};h(null);let a=await l.signUp(e,r,t);return a.success||h(a.error),a},signIn:async(e,r)=>{h(null);let t=await l.signIn(e,r);return t.success||h(t.error),t},signOut:async()=>{h(null);let e=await l.signOut();return e.success?i(null):h(e.error),e},resetPassword:async e=>{h(null);let r=await l.resetPassword(e);return r.success||h(r.error),r},updatePassword:async e=>{h(null);let r=await l.updatePassword(e);return r.success||h(r.error),r},updateProfile:async e=>{h(null);let{name:r,student_id:t}=e,a=await l.updateProfile({name:r,student_id:t});if(a.success){let e=await l.getCurrentUser();e.success&&i(e.user)}else h(a.error);return a},verifyOtp:async function(e,r){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"email";h(null);let a=await l.verifyOtp(e,r,t);return a.success||h(a.error),a},resendOtp:async function(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup";h(null);let t=await l.resendOtp(e,r);return t.success||h(t.error),t},isAuthenticated:!!t,isAdmin:(null==t?void 0:t.role)==="admin"};return(0,a.jsx)(o.Provider,{value:g,children:r})}},76392:(e,r,t)=>{t.d(r,{B:()=>h,default:()=>p});var a=t(95155),s=t(66766),n=t(6874),l=t.n(n),o=t(12115),i=t(35695),c=t(25215);let u={src:"/_next/static/media/logo.9b46094d.png",height:561,width:561,blurDataURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAICAMAAADz0U65AAAANlBMVEXZ2dmKioq6urru7u7d3d1MaXG+vr7r6+vi4uLj4+OBgYHk5OT5+fm0tLTJycllZWVra2uGhoYGE54GAAAACnRSTlP0/vn//QD7LrDuL+74ngAAAAlwSFlzAAALEwAACxMBAJqcGAAAADpJREFUeJwFwYkBgDAIBMGNQA7Io/1X6wyhxFOB8DNXiXS68QRW97pQdt7vGuR+xpg7UZnZLhHKqlT8Oz8BtC3cZ1IAAAAASUVORK5CYII=",blurWidth:8,blurHeight:8};var d=t(36184);let h=(0,o.createContext)({isHeaderVisible:!0}),g=(0,o.forwardRef)((e,r)=>{var t,n;let[g,p]=(0,o.useState)(!1),[m,f]=(0,o.useState)(!1),w=(0,o.useRef)(null),[y,b]=(0,o.useState)(!0),x=(0,o.useRef)(0),v=(0,o.useRef)(0),{user:N,loading:A,signOut:j,isAuthenticated:C,isAdmin:k}=(0,c.A)(),I=(0,i.usePathname)(),U=()=>p(!1),_=async()=>{await j(),U()};(0,o.useEffect)(()=>{let e=()=>{let e=window.scrollY;if(g)return void b(!0);"up"==(e>x.current?"down":"up")||e<100?(b(!0),v.current=0):(v.current+=e-x.current,v.current>150&&b(!1)),x.current=e};return window.addEventListener("scroll",e,{passive:!0}),()=>{window.removeEventListener("scroll",e)}},[g]),(0,o.useEffect)(()=>{if(!g)return;let e=document.querySelector("footer"),r=w.current;if(!e||!r)return;let t=()=>{let t=r.getBoundingClientRect(),a=e.getBoundingClientRect();f(t.bottom>a.top&&t.top<a.bottom)};return t(),window.addEventListener("scroll",t,{passive:!0}),()=>{window.removeEventListener("scroll",t)}},[g]);let E=[{href:"/",label:"首頁"},{href:"/ai-assistant",label:"AI 獎學金助理"},{href:"/resource",label:"FAQ 及相關資源"},{href:"/terms-and-privacy",label:"服務條款",auth:!0},{href:"/manage",label:"管理後台",auth:!0,admin:!0}],O=C?k?E.filter(e=>e.auth||!e.hasOwnProperty("auth")):E.filter(e=>!e.admin):[...E.filter(e=>!e.auth),{href:"/login",label:"登入"},{href:"/register",label:"註冊"}];return(0,a.jsx)(h.Provider,{value:{isHeaderVisible:y},children:(0,a.jsxs)("header",{className:"header-fixed ".concat(y?"opacity-100":"opacity-0 pointer-events-none"," ").concat(g?"menu-open":""),ref:r,onKeyDown:e=>{"Escape"===e.key&&U()},children:[(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-3 sm:px-6 lg:px-8 h-full flex items-center justify-between relative z-10",children:[(0,a.jsx)(()=>(0,a.jsxs)(l(),{href:"/",className:"flex items-center space-x-3 focus:outline-none p-1","aria-label":"回到首頁",onClick:U,children:[(0,a.jsx)(s.default,{src:u,alt:"NCUE Logo",width:52,height:52,className:"h-10 w-10 sm:h-12 sm:w-12 rounded-full",priority:!0}),(0,a.jsx)("h1",{className:"font-bold text-base sm:text-lg whitespace-nowrap transition-colors duration-300",style:{color:g&&m?"var(--primary-light)":"var(--primary)"},children:"生輔組校外獎助學金資訊平台"})]}),{}),(0,a.jsxs)("nav",{className:"hidden lg:flex items-center space-x-1 lg:space-x-2",role:"navigation",children:[O.map(e=>(0,a.jsx)(l(),{href:e.href,className:"nav-link underline-extend navbar-link ".concat(I===e.href?"active":""),children:e.label},e.href)),C&&(0,a.jsxs)("div",{className:"relative group ml-4",children:[(0,a.jsxs)("button",{className:"flex flex-row items-center space-x-2 nav-link navbar-link",children:[(0,a.jsxs)("span",{children:["Hi, ",(null==N||null==(t=N.user_metadata)?void 0:t.name)||"User"]}),(0,a.jsx)("svg",{className:"w-4 h-4 transition-transform group-hover:rotate-180",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})]}),(0,a.jsxs)("div",{className:"absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg z-50 opacity-0 invisible group-hover:opacity-100 group-hover:visible transition-all p-2",children:[(0,a.jsx)(l(),{href:"/profile",className:"block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 rounded-md",children:"個資管理"}),(0,a.jsx)("button",{onClick:_,className:"block w-full text-left px-4 py-2 text-red-600 hover:bg-red-50 rounded-md",children:"登出"})]})]})]}),(0,a.jsx)("div",{className:"lg:hidden",children:(0,a.jsx)(d.A,{variant:"ghost",className:"text-muted z-20","aria-label":"選單",onClick:()=>p(!g),children:(0,a.jsxs)("div",{className:"relative w-6 h-6",children:[(0,a.jsx)("span",{className:"absolute left-0 w-6 h-0.5 bg-current transform transition-all duration-300 ease-in-out ".concat(g?"rotate-45 top-1/2 -translate-y-1/2":"top-1")}),(0,a.jsx)("span",{className:"absolute left-0 w-6 h-0.5 bg-current transition-all duration-300 ease-in-out top-1/2 -translate-y-1/2 ".concat(g?"opacity-0":"opacity-100")}),(0,a.jsx)("span",{className:"absolute left-0 w-6 h-0.5 bg-current transform transition-all duration-300 ease-in-out ".concat(g?"-rotate-45 top-1/2 -translate-y-1/2":"bottom-1")})]})})})]}),(0,a.jsxs)("div",{ref:w,className:"lg:hidden absolute left-0 w-full \n						bg-surface/85 backdrop-blur-lg shadow-lg \n						transition-all duration-300 ease-in-out overflow-y-auto \n						".concat(g?"max-h-[570px] top-0":"max-h-0 top-full"),children:[(0,a.jsx)("div",{style:{height:"var(--header-height)"}}),(0,a.jsxs)("div",{className:"p-4 space-y-2",children:[O.map((e,r)=>(0,a.jsx)(l(),{href:e.href,className:"block w-full text-left px-4 py-3 my-1 rounded-lg text-lg \n									transition-all duration-300 ease-in-out\n									".concat(g?"opacity-100 translate-y-0":"opacity-0 -translate-y-3","\n									").concat(I===e.href?m?"bg-white/25 text-white":"bg-[#00A6D6]/20 backdrop-blur-sm text-primary font-semibold":m?"text-white":"text-text"),style:{transitionDelay:g?"".concat(50*r,"ms"):"0ms"},onClick:U,children:e.label},"mobile-".concat(e.href))),C&&(0,a.jsxs)("div",{className:"border-t pt-4 mt-4 transition-all duration-300 ease-in-out ".concat(m?"border-white/20":"border-t-gray-200"," ").concat(g?"opacity-100":"opacity-0"),style:{transitionDelay:g?"".concat(50*O.length,"ms"):"0ms"},children:[(0,a.jsxs)("div",{className:"text-left px-4 py-2 transition-colors duration-200 ".concat(m?"text-white":"text-text"),children:["Hi, ",(null==N||null==(n=N.user_metadata)?void 0:n.name)||"User"]}),(0,a.jsx)(l(),{href:"/profile",className:"block w-full text-left px-4 py-3 rounded-lg text-lg transition-colors duration-200 ".concat(m?"text-white hover:bg-white/10":"text-gray-700 hover:bg-gray-100"),onClick:U,children:"個資管理"}),(0,a.jsx)("hr",{className:"my-1 ".concat(m?"border-white/20":"border-t-gray-200")}),(0,a.jsx)("button",{className:"block w-full text-left px-4 py-3 rounded-lg text-lg transition-colors duration-200 ".concat(m?"text-red-400 hover:bg-white/10":"text-red-600 hover:bg-red-50"),onClick:_,children:"登出"})]})]})]})]})})});g.displayName="Header";let p=g}}]);